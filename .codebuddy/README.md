# CodeBuddy 配置说明

本目录包含 cLLM 项目的 CodeBuddy AI 编程助手配置。

## 📁 目录结构

```
.codebuddy/
├── README.md                    # 本说明文件
├── project.yaml                 # 项目元数据配置
├── rules/                       # 约束规则目录
│   ├── always/                  # 始终生效的规则
│   │   ├── 00_core_constraints.md       # 核心约束 (优先级最高)
│   │   ├── 01_architecture_rules.md     # 架构设计约束
│   │   └── 02_workflow_standards.md     # 工作流程标准
│   ├── manual/                  # 手动触发的规则
│   │   ├── performance_optimization.md  # 性能优化指南
│   │   └── refactoring_guide.md         # 重构指南
│   └── requested/               # 按需加载的规则
│       └── tokenizer_integration.md     # Tokenizer集成规范
├── memory/                      # 记忆存储 (自动生成)
└── context/                     # 上下文缓存 (自动生成)
```

## 📋 规则说明

### Always 规则 (自动加载)

这些规则在每次 AI 对话时自动生效,无需手动触发:

1. **00_core_constraints.md** - 核心约束规则
   - 项目基本信息
   - 绝对禁止事项
   - 文件操作规范
   - 编码风格规范
   - 日志和测试规范

2. **01_architecture_rules.md** - 架构设计约束
   - 模块化设计原则
   - 依赖规则
   - 接口定义规范
   - 设计模式应用
   - 线程安全规范

3. **02_workflow_standards.md** - 工作流程标准
   - 需求理解流程
   - 信息收集策略
   - 任务规划方法
   - 代码修改规范
   - 测试验证流程

### Manual 规则 (手动触发)

当用户提到特定关键词时使用:

1. **performance_optimization.md** - 性能优化
   - 触发词: "优化"、"加速"、"性能"、"慢"
   - 包含: CPU/内存/I/O/并发优化
   - 包含: cLLM特定优化策略
   - 包含: Profiling工具使用

2. **refactoring_guide.md** - 代码重构
   - 触发词: "重构"、"优化结构"、"解耦"
   - 包含: 重构原则和检查清单
   - 包含: 常见重构模式
   - 包含: 重构后验证方法

### Requested 规则 (按需加载)

特定场景下使用:

1. **tokenizer_integration.md** - Tokenizer集成
   - 场景: 集成新的Tokenizer实现
   - 包含: 接口实现规范
   - 包含: CMake配置方法
   - 包含: 测试验证流程

## 🚀 使用方法

### 对 AI 来说

AI 会自动读取 `always/` 目录中的规则,并在用户提到相关关键词时加载 `manual/` 和 `requested/` 规则。

### 对开发者来说

开发者无需手动操作,只需:

1. 与 CodeBuddy AI 对话时,AI 会自动遵守这些约束
2. 如需修改规则,直接编辑对应的 `.md` 文件
3. 如需添加新规则,在相应目录创建新的 `.md` 文件

## 📝 规则编写规范

### 文件命名

- Always 规则: `00_`, `01_`, `02_` 等数字前缀 (控制加载顺序)
- Manual 规则: 描述性名称,如 `performance_optimization.md`
- Requested 规则: 场景名称,如 `tokenizer_integration.md`

### 内容格式

```markdown
# 规则标题

> **优先级/触发条件**: 说明

---

## 章节1

内容...

### 子章节

具体规则...
```

### 规则编写建议

1. **具体明确** - 用 ✅/❌ 清晰标记允许/禁止的操作
2. **可执行** - 提供代码示例和具体步骤
3. **可验证** - 提供检查清单和验证方法
4. **分层组织** - 按优先级和场景分类

## 🔒 重要提示

### 禁止操作

- ❌ **不要删除 `.codebuddy/` 目录**
- ❌ **不要手动修改 `memory/` 和 `context/` 目录**
- ❌ **不要在规则中添加执行命令** (AI 不会自动执行)

### 建议操作

- ✅ 定期审查和更新规则
- ✅ 根据项目演进补充新规则
- ✅ 记录常见错误到规则中
- ✅ 分享最佳实践到团队

## 📊 规则效果

使用这些规则后,AI 将:

1. **避免常见错误**
   - 不会重写整个文件
   - 不会创建临时脚本
   - 不会破坏项目结构

2. **提高代码质量**
   - 遵循编码规范
   - 保持架构一致性
   - 使用最佳实践

3. **提升开发效率**
   - 并行执行工具调用
   - 精确修改代码
   - 及时验证结果

4. **减少沟通成本**
   - 理解项目约束
   - 自动遵守规范
   - 主动完成任务

## 📚 相关文档

- **项目文档**: `docs/` 目录
- **编码规范**: `docs/C++编程规范.md`
- **架构设计**: `docs/cLLM详细设计.md`
- **模块设计**: `docs/modules/` 目录

## 🔧 维护指南

### 何时更新规则

1. 发现 AI 重复犯错
2. 项目规范发生变化
3. 引入新的技术栈
4. 新增重要模块

### 如何验证规则

1. 让 AI 执行典型任务
2. 观察 AI 是否遵守规则
3. 检查输出是否符合预期
4. 记录问题并改进规则

### 规则版本管理

- 规则文件受 Git 版本控制
- 重要修改需要 commit
- 建议添加修改日期和版本号

## 🤝 团队协作

### 规则共享

- 所有开发者共享相同的规则
- 通过 Git 同步规则变更
- 讨论和评审规则修改

### 规则冲突

- 优先级: always > manual > requested
- 编号越小优先级越高 (00 > 01 > 02)
- 新规则不应与现有规则冲突

## 📞 支持

如有问题,请查阅:
- CodeBuddy 官方文档
- 项目 `docs/` 目录
- 或联系项目维护者

---

**最后更新**: 2026-01-11  
**维护者**: cLLM Core Team  
**版本**: v1.0
